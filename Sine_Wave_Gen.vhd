-- Generated by sine_wave_generator.c
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.NUMERIC_STD.ALL;

entity Sine_Wave_Gen is
Port (
    M_AXIS_ACLK    : in STD_LOGIC; --- This should be 120000000 Hz
    M_AXIS_ARESETN : in STD_LOGIC;   --- negative asynch reset
    M_AXIS_tDATA   : out std_logic_vector(15 downto 0); --- ACTUAL_OUTPUT_SIGNAL_FREQUENCY : 600000 Hz
    M_AXIS_tVALID  : out std_logic
);
end Sine_Wave_Gen;

architecture Behavioral of Sine_Wave_Gen is

constant SIN_TABLE_Length          : integer := 100;
constant SIN_DATA_WIDTH            : integer := 16;
type SIN_TABLEType is array(0 to SIN_TABLE_Length-1) of integer;
constant SIN_TABLE : SIN_TABLEType :=(0,2057,4106,6140,8149,10125,12062,13951,15786,17557,19260,20887,22431,23886,25248,26509,27666,28714,29649,30466,31164,31738,32187,32509,32703,32767,32703,32509,32187,31738,31164,30466,29649,28714,27666,26509,25248,23886,22431,20887,19260,17557,15786,13951,12062,10125,8149,6140,4106,2057,0,-2057,-4106,-6140,-8149,-10125,-12062,-13951,-15786,-17558,-19260,-20887,-22431,-23886,-25248,-26509,-27666,-28714,-29649,-30466,-31164,-31738,-32187,-32509,-32703,-32767,-32703,-32509,-32187,-31738,-31164,-30466,-29649,-28714,-27666,-26509,-25248,-23886,-22431,-20887,-19260,-17557,-15786,-13951,-12062,-10125,-8149,-6140,-4106,-2057);
attribute ram_style : string;
attribute ram_style of SIN_TABLE : constant is "block";
signal indx_cycle                  : integer := 1;
signal sin_indx                    : unsigned(6 downto 0) := (others=>'0');
signal cnt                         : unsigned(31 downto 0) := (others=>'0');

begin
process(M_AXIS_ACLK)
begin
    if rising_edge(M_AXIS_ACLK) then
       if (M_AXIS_ARESETN='0') then    --- Asynch reset
           cnt             <= (others=>'0');
           sin_indx        <= (others=>'0');
           M_AXIS_tVALID   <= '0';
       else
           cnt             <= cnt+1;
           M_AXIS_tVALID   <= '0';
           if(cnt=indx_cycle)then
               cnt        <= (others=>'0');
               sin_indx   <= sin_indx+1;
               if(sin_indx=SIN_TABLE_Length-1) then
                   sin_indx       <= (others=>'0');
               end if;
               M_AXIS_tVALID  <= '1';
               M_AXIS_tDATA   <= std_logic_vector(to_signed(SIN_TABLE(to_integer(sin_indx)),SIN_DATA_WIDTH));
           end if;
       end if;
    end if;
end process;
end Behavioral;
